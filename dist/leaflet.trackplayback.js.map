{"version":3,"sources":["webpack:///webpack/universalModuleDefinition","webpack:///webpack/bootstrap","webpack:///external {\"root\":\"L\",\"commonjs\":\"leaflet\",\"commonjs2\":\"leaflet\",\"amd\":\"leaflet\"}","webpack:///./src/leaflet.trackplayback/clock.js","webpack:///./src/leaflet.trackplayback/tracklayer.js","webpack:///./src/leaflet.trackplayback/draw.js","webpack:///./src/leaflet.trackplayback/util.js","webpack:///./src/leaflet.trackplayback/track.js","webpack:///./src/leaflet.trackplayback/trackcontroller.js","webpack:///./src/leaflet.trackplayback/trackplayback.js","webpack:///./src/leaflet.trackplayback/index.js"],"names":["root","factory","exports","module","require","define","amd","a","i","window","__WEBPACK_EXTERNAL_MODULE__0__","installedModules","__webpack_require__","moduleId","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","Clock","Class","extend","includes","Evented","options","speed","maxSpeed","initialize","trackController","setOptions","this","_trackController","_endTime","getMaxTime","_curTime","getMinTime","_speed","_maxSpeed","_intervalID","_lastFpsUpdateTime","start","Util","requestAnimFrame","_tick","stop","cancelAnimFrame","rePlaying","slowSpeed","quickSpeed","getSpeed","getCurTime","getStartTime","getEndTime","isPlaying","setCursor","time","drawTracksByTime","fire","setSpeed","_caculatefpsTime","now","Date","isPause","stepTime","Math","pow","TrackLayer","Renderer","padding","onAdd","map","_container","DomUtil","getPane","pane","appendChild","_ctx","getContext","_update","onRemove","remove","getContainer","getBounds","_bounds","_map","_animatingZoom","b","container","size","getSize","Browser","retina","setPosition","min","width","x","height","y","style","scale","translate","Draw","trackPointOptions","isDraw","useCanvas","stroke","color","fill","fillColor","opacity","radius","trackLineOptions","weight","targetOptions","useImg","imgUrl","showText","toolTipOptions","offset","direction","permanent","_showTrackPoint","_showTrackLine","on","_onmousemoveEvt","_trackLayer","addTo","_trackLayerUpdate","_canvas","_bufferTracks","_trackPointFeatureGroup","featureGroup","img","Image","onload","_targetImg","onerror","Error","src","update","drawTrack","trackpoints","push","_drawTrack","showTrackPoint","hideTrackPoint","showTrackLine","hideTrackLine","off","hasLayer","removeLayer","clear","_clearLayer","length","forEach","element","index","e","point","layerPoint","leni","j","len","tpoint","_getLayerPoint","distanceTo","_opentoolTip","_tooltip","cursor","trackpoint","latlng","latLng","lat","lng","tooltip","setLatLng","setContent","_getTooltipText","_drawTrackLine","targetPoint","_drawShipImage","_drawShipCanvas","_drawtxt","parseInt","dir","_drawTrackPointsCanvas","_drawTrackPointsSvg","tp0","save","beginPath","moveTo","tpi","lineTo","globalAlpha","strokeStyle","lineWidth","fillStyle","restore","isOrigin","latLngToLayerPoint","arc","PI","cricleMarker","circleMarker","bindTooltip","addLayer","text","font","textAlign","textBaseline","fillText","rotate","w","h","dh","closePath","drawImage","targetobj","content","info","join","bounds","clearRect","clearLayers","isArray","arr","Array","toString","Track","trackData","item","_trackPoints","_timeTick","addTrackPoint","trackPoint","_addTrackPoint","getTimes","times","getStartTrackPoint","getEndTrackPoint","getTrackPointByTime","_getCalculateTrackPointByTime","endpoint","startPt","endPt","left","right","t0","t1","p0","p1","v","sinx","cosx","step","asin","undefined","getTrackPointsBeforeTime","tpoints","_sortTrackPointsByTime","_updatetimeTick","tmp","TrackController","tracks","draw","_tracks","addTrack","_draw","_updateTime","_minTime","_maxTime","track","tps","stime","etime","TrackPlayBack","data","drawOptions","_initTracks","clock","clockOptions","dispose","trackplayback"],"mappings":"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","file":"leaflet.trackplayback.js","sourcesContent":["(function webpackUniversalModuleDefinition(root, factory) {\n\tif(typeof exports === 'object' && typeof module === 'object')\n\t\tmodule.exports = factory(require(\"leaflet\"));\n\telse if(typeof define === 'function' && define.amd)\n\t\tdefine([\"leaflet\"], factory);\n\telse {\n\t\tvar a = typeof exports === 'object' ? factory(require(\"leaflet\")) : factory(root[\"L\"]);\n\t\tfor(var i in a) (typeof exports === 'object' ? exports : root)[i] = a[i];\n\t}\n})(window, function(__WEBPACK_EXTERNAL_MODULE__0__) {\nreturn "," \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n","module.exports = __WEBPACK_EXTERNAL_MODULE__0__;","import L from 'leaflet'\r\n/**\r\n * Clock type, control track to play animation\r\n */\r\nexport const Clock = L.Class.extend({\r\n\r\n  includes: L.Evented.prototype,\r\n\r\n  options: {\r\n    // Play speed\r\n    // Calculation method fpstime * Math.pow(2, this._speed-1)\r\n    speed: 12,\r\n    // Maximum playback speed\r\n    maxSpeed: 65\r\n  },\r\n\r\n  initialize: function (trackController, options) {\r\n    L.setOptions(this, options)\r\n\r\n    this._trackController = trackController\r\n    this._endTime = this._trackController.getMaxTime()\r\n    this._curTime = this._trackController.getMinTime()\r\n    this._speed = this.options.speed\r\n    this._maxSpeed = this.options.maxSpeed\r\n    this._intervalID = null\r\n    this._lastFpsUpdateTime = 0\r\n  },\r\n\r\n  start: function () {\r\n    if (this._intervalID) return\r\n    this._intervalID = L.Util.requestAnimFrame(this._tick, this)\r\n  },\r\n\r\n  stop: function () {\r\n    if (!this._intervalID) return\r\n    L.Util.cancelAnimFrame(this._intervalID)\r\n    this._intervalID = null\r\n    this._lastFpsUpdateTime = 0\r\n  },\r\n\r\n  rePlaying: function () {\r\n    this.stop()\r\n    this._curTime = this._trackController.getMinTime()\r\n    this.start()\r\n  },\r\n\r\n  slowSpeed: function () {\r\n    this._speed = this._speed <= 1 ? this._speed : this._speed - 1\r\n    if (this._intervalID) {\r\n      this.stop()\r\n      this.start()\r\n    }\r\n  },\r\n\r\n  quickSpeed: function () {\r\n    this._speed = this._speed >= this._maxSpeed ? this._speed : this._speed + 1\r\n    if (this._intervalID) {\r\n      this.stop()\r\n      this.start()\r\n    }\r\n  },\r\n\r\n  getSpeed: function () {\r\n    return this._speed\r\n  },\r\n\r\n  getCurTime: function () {\r\n    return this._curTime\r\n  },\r\n\r\n  getStartTime: function () {\r\n    return this._trackController.getMinTime()\r\n  },\r\n\r\n  getEndTime: function () {\r\n    return this._trackController.getMaxTime()\r\n  },\r\n\r\n  isPlaying: function () {\r\n    return !!this._intervalID\r\n  },\r\n\r\n  setCursor: function (time) {\r\n    this._curTime = time\r\n    this._trackController.drawTracksByTime(this._curTime)\r\n    this.fire('tick', {\r\n      time: this._curTime\r\n    })\r\n  },\r\n\r\n  setSpeed: function (speed) {\r\n    this._speed = speed\r\n    if (this._intervalID) {\r\n      this.stop()\r\n      this.start()\r\n    }\r\n  },\r\n\r\n  // Calculate the time interval between two frames, unit: second\r\n  _caculatefpsTime: function (now) {\r\n    let time\r\n    if (this._lastFpsUpdateTime === 0) {\r\n      time = 0\r\n    } else {\r\n      time = now - this._lastFpsUpdateTime\r\n    }\r\n    this._lastFpsUpdateTime = now\r\n    // Convert milliseconds to seconds\r\n    time = time / 1000\r\n    return time\r\n  },\r\n\r\n  _tick: function () {\r\n    const now = +new Date()\r\n    const fpstime = this._caculatefpsTime(now)\r\n    let isPause = false\r\n    const stepTime = fpstime * Math.pow(2, this._speed - 1)\r\n    this._curTime += stepTime\r\n    if (this._curTime >= this._endTime) {\r\n      this._curTime = this._endTime\r\n      isPause = true\r\n    }\r\n    this._trackController.drawTracksByTime(this._curTime)\r\n    this.fire('tick', {\r\n      time: this._curTime\r\n    })\r\n    if (!isPause) this._intervalID = L.Util.requestAnimFrame(this._tick, this)\r\n  }\r\n})\r\n\r\nexport const clock = function (trackController, options) {\r\n  return new Clock(trackController, options)\r\n}\r\n","import L from 'leaflet'\r\n\r\n/**\r\n * Track layer\r\n */\r\nexport const TrackLayer = L.Renderer.extend({\r\n\r\n  initialize: function (options) {\r\n    L.Renderer.prototype.initialize.call(this, options)\r\n    this.options.padding = 0.1\r\n  },\r\n\r\n  onAdd: function (map) {\r\n    this._container = L.DomUtil.create('canvas', 'leaflet-zoom-animated')\r\n\r\n    var pane = map.getPane(this.options.pane)\r\n    pane.appendChild(this._container)\r\n\r\n    this._ctx = this._container.getContext('2d')\r\n\r\n    this._update()\r\n  },\r\n\r\n  onRemove: function (map) {\r\n    L.DomUtil.remove(this._container)\r\n  },\r\n\r\n  getContainer: function () {\r\n    return this._container\r\n  },\r\n\r\n  getBounds: function () {\r\n    return this._bounds\r\n  },\r\n\r\n  _update: function () {\r\n    if (this._map._animatingZoom && this._bounds) {\r\n      return\r\n    }\r\n\r\n    L.Renderer.prototype._update.call(this)\r\n\r\n    var b = this._bounds\r\n\r\n    var container = this._container\r\n\r\n    var size = b.getSize()\r\n\r\n    var m = L.Browser.retina ? 2 : 1\r\n\r\n    L.DomUtil.setPosition(container, b.min)\r\n\r\n    // set canvas size (also clearing it); use double size on retina\r\n    container.width = m * size.x\r\n    container.height = m * size.y\r\n    container.style.width = size.x + 'px'\r\n    container.style.height = size.y + 'px'\r\n\r\n    if (L.Browser.retina) {\r\n      this._ctx.scale(2, 2)\r\n    }\r\n\r\n    // translate so we use the same path coordinates after canvas element moves\r\n    this._ctx.translate(-b.min.x, -b.min.y)\r\n\r\n    // Tell paths to redraw themselves\r\n    this.fire('update')\r\n  }\r\n})\r\n","import L from 'leaflet'\r\nimport { TrackLayer } from './tracklayer'\r\n\r\n/**\r\n * Drawing class\r\n * Complete the drawing of trajectory lines, trajectory points, and targets\r\n */\r\nexport const Draw = L.Class.extend({\r\n\r\n  trackPointOptions: {\r\n    isDraw: false,\r\n    useCanvas: true,\r\n    stroke: false,\r\n    color: '#ef0300',\r\n    fill: true,\r\n    fillColor: '#ef0300',\r\n    opacity: 0.3,\r\n    radius: 4\r\n  },\r\n  trackLineOptions: {\r\n    isDraw: false,\r\n    stroke: true,\r\n    color: '#1C54E2', // stroke color\r\n    weight: 2,\r\n    fill: false,\r\n    fillColor: '#000',\r\n    opacity: 0.3\r\n  },\r\n  targetOptions: {\r\n    useImg: false,\r\n    imgUrl: '../../static/images/ship.png',\r\n    showText: false,\r\n    width: 8,\r\n    height: 18,\r\n    color: '#00f', // stroke color\r\n    fillColor: '#9FD12D'\r\n  },\r\n  toolTipOptions: {\r\n    offset: [0, 0],\r\n    direction: 'top',\r\n    permanent: false\r\n  },\r\n\r\n  initialize: function (map, options) {\r\n    L.extend(this.trackPointOptions, options.trackPointOptions)\r\n    L.extend(this.trackLineOptions, options.trackLineOptions)\r\n    L.extend(this.targetOptions, options.targetOptions)\r\n    L.extend(this.toolTipOptions, options.toolTipOptions)\r\n\r\n    this._showTrackPoint = this.trackPointOptions.isDraw\r\n    this._showTrackLine = this.trackLineOptions.isDraw\r\n\r\n    this._map = map\r\n    this._map.on('mousemove', this._onmousemoveEvt, this)\r\n\r\n    this._trackLayer = new TrackLayer().addTo(map)\r\n    this._trackLayer.on('update', this._trackLayerUpdate, this)\r\n\r\n    this._canvas = this._trackLayer.getContainer()\r\n    this._ctx = this._canvas.getContext('2d')\r\n\r\n    this._bufferTracks = []\r\n\r\n    if (!this.trackPointOptions.useCanvas) {\r\n      this._trackPointFeatureGroup = L.featureGroup([]).addTo(map)\r\n    }\r\n\r\n    // If the target uses a picture, load the picture first\r\n    if (this.targetOptions.useImg) {\r\n      const img = new Image()\r\n      img.onload = () => {\r\n        this._targetImg = img\r\n      }\r\n      img.onerror = () => {\r\n        throw new Error('img load error!')\r\n      }\r\n      img.src = this.targetOptions.imgUrl\r\n    }\r\n  },\r\n\r\n  update: function () {\r\n    this._trackLayerUpdate()\r\n  },\r\n\r\n  drawTrack: function (trackpoints) {\r\n    this._bufferTracks.push(trackpoints)\r\n    this._drawTrack(trackpoints)\r\n  },\r\n\r\n  showTrackPoint: function () {\r\n    this._showTrackPoint = true\r\n    this.update()\r\n  },\r\n\r\n  hideTrackPoint: function () {\r\n    this._showTrackPoint = false\r\n    this.update()\r\n  },\r\n\r\n  showTrackLine: function () {\r\n    this._showTrackLine = true\r\n    this.update()\r\n  },\r\n\r\n  hideTrackLine: function () {\r\n    this._showTrackLine = false\r\n    this.update()\r\n  },\r\n\r\n  remove: function () {\r\n    this._bufferTracks = []\r\n    this._trackLayer.off('update', this._trackLayerUpdate, this)\r\n    this._map.off('mousemove', this._onmousemoveEvt, this)\r\n    if (this._map.hasLayer(this._trackLayer)) {\r\n      this._map.removeLayer(this._trackLayer)\r\n    }\r\n    if (this._map.hasLayer(this._trackPointFeatureGroup)) {\r\n      this._map.removeLayer(this._trackPointFeatureGroup)\r\n    }\r\n  },\r\n\r\n  clear: function () {\r\n    this._clearLayer()\r\n    this._bufferTracks = []\r\n  },\r\n\r\n  _trackLayerUpdate: function () {\r\n    if (this._bufferTracks.length) {\r\n      this._clearLayer()\r\n      this._bufferTracks.forEach(function (element, index) {\r\n        this._drawTrack(element)\r\n      }.bind(this))\r\n    }\r\n  },\r\n\r\n  _onmousemoveEvt: function (e) {\r\n    if (!this._showTrackPoint) {\r\n      return\r\n    }\r\n    const point = e.layerPoint\r\n    if (this._bufferTracks.length) {\r\n      for (let i = 0, leni = this._bufferTracks.length; i < leni; i++) {\r\n        for (let j = 0, len = this._bufferTracks[i].length; j < len; j++) {\r\n          const tpoint = this._getLayerPoint(this._bufferTracks[i][j])\r\n          if (point.distanceTo(tpoint) <= this.trackPointOptions.radius) {\r\n            this._opentoolTip(this._bufferTracks[i][j])\r\n            return\r\n          }\r\n        }\r\n      }\r\n    }\r\n    if (this._map.hasLayer(this._tooltip)) {\r\n      this._map.removeLayer(this._tooltip)\r\n    }\r\n    this._canvas.style.cursor = 'pointer'\r\n  },\r\n\r\n  _opentoolTip: function (trackpoint) {\r\n    if (this._map.hasLayer(this._tooltip)) {\r\n      this._map.removeLayer(this._tooltip)\r\n    }\r\n    this._canvas.style.cursor = 'default'\r\n    const latlng = L.latLng(trackpoint.lat, trackpoint.lng)\r\n    const tooltip = this._tooltip = L.tooltip(this.toolTipOptions)\r\n    tooltip.setLatLng(latlng)\r\n    tooltip.addTo(this._map)\r\n    tooltip.setContent(this._getTooltipText(trackpoint))\r\n  },\r\n\r\n  _drawTrack: function (trackpoints) {\r\n    // draw trajectory\r\n    if (this._showTrackLine) {\r\n      this._drawTrackLine(trackpoints)\r\n    }\r\n    // Draw a boat\r\n    const targetPoint = trackpoints[trackpoints.length - 1]\r\n    if (this.targetOptions.useImg && this._targetImg) {\r\n      this._drawShipImage(targetPoint)\r\n    } else {\r\n      this._drawShipCanvas(targetPoint)\r\n    }\r\n    // Draw label information\r\n    if (this.targetOptions.showText) {\r\n      this._drawtxt(`Heading：${parseInt(targetPoint.dir)}degrees`, targetPoint)\r\n    }\r\n    // Draw the passing track points\r\n    if (this._showTrackPoint) {\r\n      if (this.trackPointOptions.useCanvas) {\r\n        this._drawTrackPointsCanvas(trackpoints)\r\n      } else {\r\n        this._drawTrackPointsSvg(trackpoints)\r\n      }\r\n    }\r\n  },\r\n\r\n  _drawTrackLine: function (trackpoints) {\r\n    const options = this.trackLineOptions\r\n    const tp0 = this._getLayerPoint(trackpoints[0])\r\n    this._ctx.save()\r\n    this._ctx.beginPath()\r\n    // Draw trajectory\r\n    this._ctx.moveTo(tp0.x, tp0.y)\r\n    for (let i = 1, len = trackpoints.length; i < len; i++) {\r\n      const tpi = this._getLayerPoint(trackpoints[i])\r\n      this._ctx.lineTo(tpi.x, tpi.y)\r\n    }\r\n    this._ctx.globalAlpha = options.opacity\r\n    if (options.stroke) {\r\n      this._ctx.strokeStyle = options.color\r\n      this._ctx.lineWidth = options.weight\r\n      this._ctx.stroke()\r\n    }\r\n    if (options.fill) {\r\n      this._ctx.fillStyle = options.fillColor\r\n      this._ctx.fill()\r\n    }\r\n    this._ctx.restore()\r\n  },\r\n\r\n  _drawTrackPointsCanvas: function (trackpoints) {\r\n    const options = this.trackPointOptions\r\n    this._ctx.save()\r\n    for (let i = 0, len = trackpoints.length; i < len; i++) {\r\n      if (trackpoints[i].isOrigin) {\r\n        const latLng = L.latLng(trackpoints[i].lat, trackpoints[i].lng)\r\n        const radius = options.radius\r\n        const point = this._map.latLngToLayerPoint(latLng)\r\n        this._ctx.beginPath()\r\n        this._ctx.arc(point.x, point.y, radius, 0, Math.PI * 2, false)\r\n        this._ctx.globalAlpha = options.opacity\r\n        if (options.stroke) {\r\n          this._ctx.strokeStyle = options.color\r\n          this._ctx.stroke()\r\n        }\r\n        if (options.fill) {\r\n          this._ctx.fillStyle = options.fillColor\r\n          this._ctx.fill()\r\n        }\r\n      }\r\n    }\r\n    this._ctx.restore()\r\n  },\r\n\r\n  _drawTrackPointsSvg: function (trackpoints) {\r\n    for (let i = 0, len = trackpoints.length; i < len; i++) {\r\n      if (trackpoints[i].isOrigin) {\r\n        const latLng = L.latLng(trackpoints[i].lat, trackpoints[i].lng)\r\n        const cricleMarker = L.circleMarker(latLng, this.trackPointOptions)\r\n        cricleMarker.bindTooltip(this._getTooltipText(trackpoints[i]), this.toolTipOptions)\r\n        this._trackPointFeatureGroup.addLayer(cricleMarker)\r\n      }\r\n    }\r\n  },\r\n\r\n  _drawtxt: function (text, trackpoint) {\r\n    const point = this._getLayerPoint(trackpoint)\r\n    this._ctx.save()\r\n    this._ctx.font = '12px Verdana'\r\n    this._ctx.fillStyle = '#000'\r\n    this._ctx.textAlign = 'center'\r\n    this._ctx.textBaseline = 'bottom'\r\n    this._ctx.fillText(text, point.x, point.y - 12, 200)\r\n    this._ctx.restore()\r\n  },\r\n\r\n  _drawShipCanvas: function (trackpoint) {\r\n    const point = this._getLayerPoint(trackpoint)\r\n    const rotate = trackpoint.dir || 0\r\n    const w = this.targetOptions.width\r\n    const h = this.targetOptions.height\r\n    const dh = h / 3\r\n\r\n    this._ctx.save()\r\n    this._ctx.fillStyle = this.targetOptions.fillColor\r\n    this._ctx.strokeStyle = this.targetOptions.color\r\n    this._ctx.translate(point.x, point.y)\r\n    this._ctx.rotate((Math.PI / 180) * rotate)\r\n    this._ctx.beginPath()\r\n    this._ctx.moveTo(0, 0 - h / 2)\r\n    this._ctx.lineTo(0 - w / 2, 0 - h / 2 + dh)\r\n    this._ctx.lineTo(0 - w / 2, 0 + h / 2)\r\n    this._ctx.lineTo(0 + w / 2, 0 + h / 2)\r\n    this._ctx.lineTo(0 + w / 2, 0 - h / 2 + dh)\r\n    this._ctx.closePath()\r\n    this._ctx.fill()\r\n    this._ctx.stroke()\r\n    this._ctx.restore()\r\n  },\r\n\r\n  _drawShipImage: function (trackpoint) {\r\n    const point = this._getLayerPoint(trackpoint)\r\n    const dir = trackpoint.dir || 0\r\n    const width = this.targetOptions.width\r\n    const height = this.targetOptions.height\r\n    const offset = {\r\n      x: width / 2,\r\n      y: height / 2\r\n    }\r\n    this._ctx.save()\r\n    this._ctx.translate(point.x, point.y)\r\n    this._ctx.rotate((Math.PI / 180) * dir)\r\n    this._ctx.drawImage(this._targetImg, 0 - offset.x, 0 - offset.y, width, height)\r\n    this._ctx.restore()\r\n  },\r\n\r\n  _getTooltipText: function (targetobj) {\r\n    let content = []\r\n    content.push('<table>')\r\n    if (targetobj.info && targetobj.info.length) {\r\n      for (let i = 0, len = targetobj.info.length; i < len; i++) {\r\n        content.push('<tr>')\r\n        content.push('<td>' + targetobj.info[i].key + '</td>')\r\n        content.push('<td>' + targetobj.info[i].value + '</td>')\r\n        content.push('</tr>')\r\n      }\r\n    }\r\n    content.push('</table>')\r\n    content = content.join('')\r\n    return content\r\n  },\r\n\r\n  _clearLayer: function () {\r\n    const bounds = this._trackLayer.getBounds()\r\n    if (bounds) {\r\n      const size = bounds.getSize()\r\n      this._ctx.clearRect(bounds.min.x, bounds.min.y, size.x, size.y)\r\n    } else {\r\n      this._ctx.clearRect(0, 0, this._canvas.width, this._canvas.height)\r\n    }\r\n    if (this._map.hasLayer(this._trackPointFeatureGroup)) {\r\n      this._trackPointFeatureGroup.clearLayers()\r\n    }\r\n  },\r\n\r\n  _getLayerPoint (trackpoint) {\r\n    return this._map.latLngToLayerPoint(L.latLng(trackpoint.lat, trackpoint.lng))\r\n  }\r\n})\r\n\r\nexport const draw = function (map, options) {\r\n  return new Draw(map, options)\r\n}\r\n","export function isArray (arr) {\r\n  return Array.isArray ? Array.isArray(arr) : Object.prototype.toString.call(arr) === '[object Array]'\r\n}\r\n","import L from 'leaflet'\r\nimport { isArray } from './util'\r\n\r\n/**\r\n * Track class\r\n */\r\nexport const Track = L.Class.extend({\r\n\r\n  initialize: function (trackData = [], options) {\r\n    L.setOptions(this, options)\r\n\r\n    trackData.forEach(item => {\r\n      // Add the isOrigin field to identify whether it is the original sampling point, distinguish it from the interpolation point\r\n      item.isOrigin = true\r\n    })\r\n    this._trackPoints = trackData\r\n    this._timeTick = {}\r\n    this._update()\r\n  },\r\n\r\n  addTrackPoint: function (trackPoint) {\r\n    if (isArray(trackPoint)) {\r\n      for (let i = 0, len = trackPoint.length; i < len; i++) {\r\n        this.addTrackPoint(trackPoint[i])\r\n      }\r\n    }\r\n    this._addTrackPoint(trackPoint)\r\n  },\r\n\r\n  getTimes: function () {\r\n    const times = []\r\n    for (let i = 0, len = this._trackPoints.length; i < len; i++) {\r\n      times.push(this._trackPoints[i].time)\r\n    }\r\n    return times\r\n  },\r\n\r\n  getStartTrackPoint: function () {\r\n    return this._trackPoints[0]\r\n  },\r\n\r\n  getEndTrackPoint: function () {\r\n    return this._trackPoints[this._trackPoints.length - 1]\r\n  },\r\n\r\n  getTrackPointByTime: function (time) {\r\n    return this._trackPoints[this._timeTick[time]]\r\n  },\r\n\r\n  _getCalculateTrackPointByTime: function (time) {\r\n    // First judge whether the last point is the original point\r\n    let endpoint = this.getTrackPointByTime(time)\r\n    let startPt = this.getStartTrackPoint()\r\n    let endPt = this.getEndTrackPoint()\r\n    const times = this.getTimes()\r\n    if (time < startPt.time || time > endPt.time) return\r\n    let left = 0\r\n    let right = times.length - 1\r\n    let n\r\n    // Handle only one point\r\n    if (left === right) {\r\n      return endpoint\r\n    }\r\n    // Use the [binary search] method to find out the current time interval\r\n    while (right - left !== 1) {\r\n      n = parseInt((left + right) / 2)\r\n      if (time > times[n]) left = n\r\n      else right = n\r\n    }\r\n\r\n    const t0 = times[left]\r\n    const t1 = times[right]\r\n    const t = time\r\n    const p0 = this.getTrackPointByTime(t0)\r\n    const p1 = this.getTrackPointByTime(t1)\r\n    startPt = L.point(p0.lng, p0.lat)\r\n    endPt = L.point(p1.lng, p1.lat)\r\n    const s = startPt.distanceTo(endPt)\r\n    // At the same point at different times\r\n    if (s <= 0) {\r\n      endpoint = p1\r\n      return endpoint\r\n    }\r\n    // Suppose the target is moving in a uniform straight line between two points\r\n    // Solve the velocity vector and calculate the location of the time t target\r\n    const v = s / (t1 - t0)\r\n    const sinx = (endPt.y - startPt.y) / s\r\n    const cosx = (endPt.x - startPt.x) / s\r\n    const step = v * (t - t0)\r\n    const x = startPt.x + step * cosx\r\n    const y = startPt.y + step * sinx\r\n    // Find the direction of movement of the target, 0-360 degrees\r\n    const dir = endPt.x >= startPt.x ? (Math.PI * 0.5 - Math.asin(sinx)) * 180 / Math.PI : (Math.PI * 1.5 + Math.asin(sinx)) * 180 / Math.PI\r\n\r\n    if (endpoint) {\r\n      if (endpoint.dir === undefined) {\r\n        endpoint.dir = dir\r\n      }\r\n    } else {\r\n      endpoint = {\r\n        lng: x,\r\n        lat: y,\r\n        dir: endPt.dir || dir,\r\n        isOrigin: false,\r\n        time: time\r\n      }\r\n    }\r\n    return endpoint\r\n  },\r\n\r\n  // Get the track taken before a certain point in time\r\n  getTrackPointsBeforeTime: function (time) {\r\n    const tpoints = []\r\n    for (let i = 0, len = this._trackPoints.length; i < len; i++) {\r\n      if (this._trackPoints[i].time < time) {\r\n        tpoints.push(this._trackPoints[i])\r\n      }\r\n    }\r\n    // Get the last point, linearly interpolated according to time\r\n    const endPt = this._getCalculateTrackPointByTime(time)\r\n    if (endPt) {\r\n      tpoints.push(endPt)\r\n    }\r\n    return tpoints\r\n  },\r\n\r\n  _addTrackPoint: function (trackPoint) {\r\n    trackPoint.isOrigin = true\r\n    this._trackPoints.push(trackPoint)\r\n    this._update()\r\n  },\r\n\r\n  _update: function () {\r\n    this._sortTrackPointsByTime()\r\n    this._updatetimeTick()\r\n  },\r\n\r\n  // Track points are sorted by time 【Bubble sort】\r\n  _sortTrackPointsByTime: function () {\r\n    const len = this._trackPoints.length\r\n    for (let i = 0; i < len; i++) {\r\n      for (let j = 0; j < len - 1 - i; j++) {\r\n        if (this._trackPoints[j].time > this._trackPoints[j + 1].time) {\r\n          const tmp = this._trackPoints[j + 1]\r\n          this._trackPoints[j + 1] = this._trackPoints[j]\r\n          this._trackPoints[j] = tmp\r\n        }\r\n      }\r\n    }\r\n  },\r\n\r\n  // Establish time index for track points to optimize search performance\r\n  _updatetimeTick: function () {\r\n    this._timeTick = {}\r\n    for (let i = 0, len = this._trackPoints.length; i < len; i++) {\r\n      this._timeTick[this._trackPoints[i].time] = i\r\n    }\r\n  }\r\n})\r\n\r\nexport const track = function (trackData, options) {\r\n  return new Track(trackData, options)\r\n}\r\n","import L from 'leaflet'\r\nimport { Track } from './track'\r\nimport { isArray } from './util'\r\n\r\n/**\r\n * Controller class\r\n * Control trajectory and draw\r\n */\r\nexport const TrackController = L.Class.extend({\r\n\r\n  initialize: function (tracks = [], draw, options) {\r\n    L.setOptions(this, options)\r\n\r\n    this._tracks = []\r\n    this.addTrack(tracks)\r\n\r\n    this._draw = draw\r\n\r\n    this._updateTime()\r\n  },\r\n\r\n  getMinTime: function () {\r\n    return this._minTime\r\n  },\r\n\r\n  getMaxTime: function () {\r\n    return this._maxTime\r\n  },\r\n\r\n  addTrack: function (track) {\r\n    if (isArray(track)) {\r\n      for (let i = 0, len = track.length; i < len; i++) {\r\n        this.addTrack(track[i])\r\n      }\r\n    } else if (track instanceof Track) {\r\n      this._tracks.push(track)\r\n      this._updateTime()\r\n    } else {\r\n      throw new Error('tracks must be an instance of `Track` or an array of `Track` instance!')\r\n    }\r\n  },\r\n\r\n  drawTracksByTime: function (time) {\r\n    this._draw.clear()\r\n    for (let i = 0, len = this._tracks.length; i < len; i++) {\r\n      const track = this._tracks[i]\r\n      const tps = track.getTrackPointsBeforeTime(time)\r\n      if (tps && tps.length) this._draw.drawTrack(tps)\r\n    }\r\n  },\r\n\r\n  _updateTime: function () {\r\n    this._minTime = this._tracks[0].getStartTrackPoint().time\r\n    this._maxTime = this._tracks[0].getEndTrackPoint().time\r\n    for (let i = 0, len = this._tracks.length; i < len; i++) {\r\n      const stime = this._tracks[i].getStartTrackPoint().time\r\n      const etime = this._tracks[i].getEndTrackPoint().time\r\n      if (stime < this._minTime) {\r\n        this._minTime = stime\r\n      }\r\n      if (etime > this._maxTime) {\r\n        this._maxTime = etime\r\n      }\r\n    }\r\n  }\r\n\r\n})\r\n\r\nexport const trackController = function (tracks, draw, options) {\r\n  return new TrackController(tracks, draw, options)\r\n}\r\n","import L from 'leaflet'\r\nimport { Clock } from './clock'\r\nimport { Draw } from './draw'\r\nimport { Track } from './track'\r\nimport { TrackController } from './trackcontroller'\r\nimport * as Util from './util'\r\n\r\n/**\r\n * single track data\r\n * [{lat: 30, lng: 116, time: 1502529980, heading: 300, info:[]},{},....]\r\n *\r\n * mutiple track data\r\n * [single track data, single track data, single track data]\r\n */\r\nexport const TrackPlayBack = L.Class.extend({\r\n\r\n  includes: L.Evented.prototype,\r\n\r\n  initialize: function (data, map, options = {}) {\r\n    const drawOptions = {\r\n      trackPointOptions: options.trackPointOptions,\r\n      trackLineOptions: options.trackLineOptions,\r\n      targetOptions: options.targetOptions,\r\n      toolTipOptions: options.toolTipOptions\r\n    }\r\n    this.tracks = this._initTracks(data)\r\n    this.draw = new Draw(map, drawOptions)\r\n    this.trackController = new TrackController(this.tracks, this.draw)\r\n    this.clock = new Clock(this.trackController, options.clockOptions)\r\n\r\n    this.clock.on('tick', this._tick, this)\r\n  },\r\n  start: function () {\r\n    this.clock.start()\r\n    return this\r\n  },\r\n  stop: function () {\r\n    this.clock.stop()\r\n    return this\r\n  },\r\n  rePlaying: function () {\r\n    this.clock.rePlaying()\r\n    return this\r\n  },\r\n  slowSpeed: function () {\r\n    this.clock.slowSpeed()\r\n    return this\r\n  },\r\n  quickSpeed: function () {\r\n    this.clock.quickSpeed()\r\n    return this\r\n  },\r\n  getSpeed: function () {\r\n    return this.clock.getSpeed()\r\n  },\r\n  getCurTime: function () {\r\n    return this.clock.getCurTime()\r\n  },\r\n  getStartTime: function () {\r\n    return this.clock.getStartTime()\r\n  },\r\n  getEndTime: function () {\r\n    return this.clock.getEndTime()\r\n  },\r\n  isPlaying: function () {\r\n    return this.clock.isPlaying()\r\n  },\r\n  setCursor: function (time) {\r\n    this.clock.setCursor(time)\r\n    return this\r\n  },\r\n  setSpeed: function (speed) {\r\n    this.clock.setSpeed(speed)\r\n    return this\r\n  },\r\n  showTrackPoint: function () {\r\n    this.draw.showTrackPoint()\r\n    return this\r\n  },\r\n  hideTrackPoint: function () {\r\n    this.draw.hideTrackPoint()\r\n    return this\r\n  },\r\n  showTrackLine: function () {\r\n    this.draw.showTrackLine()\r\n    return this\r\n  },\r\n  hideTrackLine: function () {\r\n    this.draw.hideTrackLine()\r\n    return this\r\n  },\r\n  dispose: function () {\r\n    this.clock.off('tick', this._tick)\r\n    this.draw.remove()\r\n    this.tracks = null\r\n    this.draw = null\r\n    this.trackController = null\r\n    this.clock = null\r\n  },\r\n  _tick: function (e) {\r\n    this.fire('tick', e)\r\n  },\r\n  _initTracks: function (data) {\r\n    const tracks = []\r\n    if (Util.isArray(data)) {\r\n      if (Util.isArray(data[0])) {\r\n        // Multiple tracks\r\n        for (let i = 0, len = data.length; i < len; i++) {\r\n          tracks.push(new Track(data[i]))\r\n        }\r\n      } else {\r\n        // Single track\r\n        tracks.push(new Track(data))\r\n      }\r\n    }\r\n    return tracks\r\n  }\r\n})\r\n\r\nexport const trackplayback = function (data, map, options) {\r\n  return new TrackPlayBack(data, map, options)\r\n}\r\n","import L from 'leaflet'\r\n\r\nimport {\r\n  TrackPlayBack,\r\n  trackplayback\r\n} from './trackplayback'\r\n\r\nL.TrackPlayBack = TrackPlayBack\r\nL.trackplayback = trackplayback\r\n"],"sourceRoot":""}